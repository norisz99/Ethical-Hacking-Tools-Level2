import hashlib
import sys
import os

# Sz√≠nek
RED = "\033[91m"
GREEN = "\033[92m"
YELLOW = "\033[93m"
RESET = "\033[0m"

# --- V√çRUS ADATB√ÅZIS (Signature Database) ---
# Itt t√°roljuk az ismert k√°rtev≈ëk ujjlenyomatait (Hash).
# A val√≥s√°gban ez t√∂bb milli√≥ soros, mi most csak a h√≠res "EICAR" tesztf√°jlt rakjuk bele.
MALWARE_DB = {
    "44d88612fea8a8f36de82e1278abb02f": "EICAR-Test-File (Nem val√≥di v√≠rus, csak teszt)",
    "5e884898da28047151d0e56f8dc62927": "Ransomware.WannaCry (Minta)",
    "e99a18c428cb38d5f260853678922e03": "Trojan.Emotet (Minta)"
}

def calculate_md5(file_path):
    """Kisz√°molja egy f√°jl MD5 lenyomat√°t."""
    hash_md5 = hashlib.md5()
    try:
        with open(file_path, "rb") as f:
            # Darabokban olvassuk be, hogy nagy f√°jlokn√°l ne teljen meg a RAM
            for chunk in iter(lambda: f.read(4096), b""):
                hash_md5.update(chunk)
        return hash_md5.hexdigest()
    except FileNotFoundError:
        return None

def scan_file(file_path):
    print(f"\n[*] F√°jl vizsg√°lata: {file_path}")
    
    if not os.path.exists(file_path):
        print(f"{RED}‚ùå HIBA: A f√°jl nem tal√°lhat√≥!{RESET}")
        return

    # 1. l√©p√©s: Lenyomat k√©sz√≠t√©se
    file_hash = calculate_md5(file_path)
    print(f"[*] F√°jl MD5 Hash: {YELLOW}{file_hash}{RESET}")

    # 2. l√©p√©s: Keres√©s az adatb√°zisban
    if file_hash in MALWARE_DB:
        virus_name = MALWARE_DB[file_hash]
        print(f"\n{RED}üö® VESZ√âLY! A f√°jl fert≈ëz√∂tt!{RESET}")
        print(f"{RED}ü¶† √âszlelt k√°rtev≈ë: {virus_name}{RESET}")
    else:
        print(f"\n{GREEN}‚úÖ A f√°jl tiszta.{RESET}")
        print("(Nincs tal√°lat a jelenlegi adatb√°zisban)")

if __name__ == "__main__":
    print("--- üõ°Ô∏è SIMPLE MALWARE SCANNER (Signature Based) ---")
    
    target_file = input("H√∫zd ide a f√°jlt vagy add meg az √∫tvonalat: ").strip().strip('"')
    
    scan_file(target_file)
    input("\nNyomj Entert a kil√©p√©shez...")