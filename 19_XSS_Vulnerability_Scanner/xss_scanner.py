import requests
import sys

# Sz√≠nek
RED = "\033[91m"
GREEN = "\033[92m"
YELLOW = "\033[93m"
RESET = "\033[0m"

# Ezeket pr√≥b√°ljuk besz√∫rni. Ha ezek megjelennek a forr√°sk√≥dban, akkor a b√∂ng√©sz≈ë lefuttatn√° ≈ëket.
XSS_PAYLOADS = [
    "<script>alert('XSS')</script>",
    "<img src=x onerror=alert(1)>",
    "<svg/onload=alert('XSS')>",
    "javascript:alert('XSS')"
]

def scan_xss(url):
    print(f"\n[*] XSS Vizsg√°lat ind√≠t√°sa: {url}")
    print("------------------------------------------------")

    if "=" not in url:
        print(f"{YELLOW}[!] Figyelem: Az URL nem tartalmaz param√©tert (pl. ?q=kereses).")
        print("    √çgy neh√©z tesztelni a Reflected XSS-t.{RESET}")
        return

    is_vulnerable = False

    for payload in XSS_PAYLOADS:
        # √ñsszerakjuk a t√°mad√≥ URL-t.
        # Itt nem hozz√°f≈±z√ºnk, hanem LECSER√âLJ√úK a param√©ter √©rt√©k√©t a payloadra.
        # Pl: page.php?name=Norisz  --->  page.php?name=<script>...
        
        # Egyszer≈±s√©g kedv√©√©rt most csak a v√©g√©re f≈±zz√ºk, vagy ha √ºres az √©rt√©k, be√≠rjuk.
        target_url = f"{url}{payload}"
        
        print(f"[*] Tesztel√©s: {payload[:30]}... ", end="")
        
        try:
            # Lek√©rj√ºk az oldalt
            response = requests.get(target_url, timeout=5, headers={"User-Agent": "Mozilla/5.0"})
            body = response.text
            
            # A L√âNYEG: Megn√©zz√ºk, hogy a payload visszaj√∂tt-e a v√°laszban.
            if payload in body:
                print(f"{RED}SEBEZHET≈ê! üö®{RESET}")
                print(f"    ‚îî‚îÄ‚îÄ A k√≥d beker√ºlt az oldal forr√°s√°ba!")
                print(f"    ‚îî‚îÄ‚îÄ Link: {target_url}")
                is_vulnerable = True
            else:
                print(f"{GREEN}OK (Sz≈±rve vagy nem t√ºkr√∂z≈ëdik){RESET}")
                
        except requests.exceptions.RequestException:
            print(f"{YELLOW}Hiba a lek√©r√©sn√©l{RESET}")

    print("------------------------------------------------")
    if is_vulnerable:
        print(f"{RED}[!] A weboldal val√≥sz√≠n≈±leg XSS hib√°t tartalmaz!{RESET}")
    else:
        print(f"{GREEN}[+] Nem tal√°ltunk Reflected XSS hib√°t.{RESET}")

if __name__ == "__main__":
    print("--- ‚ò†Ô∏è SIMPLE XSS SCANNER ---")
    # Alap√©rtelmezett teszt URL
    print("Tipp: Haszn√°ld ezt tesztnek: http://testphp.vulnweb.com/listproducts.php?cat=1")
    
    url_input = input("Add meg a teljes URL-t param√©terrel: ").strip()
    scan_xss(url_input)